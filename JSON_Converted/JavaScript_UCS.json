{
    "id": "efb9539a-1f9a-4b2f-bc25-05b96effcf7e",
    "title": "JavaScript_UCS",
    "content": [
        {
            "type": "text",
            "data": "JavaScript UCS"
        },
        {
            "type": "text",
            "data": "General Usage"
        },
        {
            "type": "text",
            "data": "JavaScript Macros (UCS:JS) are a powerful alternative to the existing traditional UCS Macros (UCS:M). This will give you much more power in coding a macro and even allow debugging with a tool like Microsoft VS Code. UCS:M and UCS:JS can run side by side. There are some slight differences in the implementation of UCS:M vs UCS:JS outlined below."
        },
        {
            "type": "text",
            "data": "Already a UCS:M guru and want to learn UCS:JS?"
        },
        {
            "type": "text",
            "data": "The quickest way to learn UCS:JS is to start with the basics. When running the UCS Wizard you can have it write it to UCS:JS."
        },
        {
            "type": "image",
            "data": "UCSJS_Wizard.png",
            "description": "[Placeholder for AI-generated description]"
        },
        {
            "type": "text",
            "data": "There are many learning and reference resources on the web for JavaScript. One we recommend is JavaScript | MDN (mozilla.org)"
        },
        {
            "type": "image",
            "data": "Information.png",
            "description": "[Placeholder for AI-generated description]"
        },
        {
            "type": "text",
            "data": "For Each"
        },
        {
            "type": "text",
            "data": "In a UCS:M, the condition used to apply the UCS to an assembly/part is defined in the UCS code using a For Each statement. The condition is evaluated during the UCS execution, if the condition is met the UCS:M continues execution else execution is terminated."
        },
        {
            "type": "text",
            "data": ";UCS:M"
        },
        {
            "type": "text",
            "data": "For Each AS|FS Part"
        },
        {
            "type": "text",
            "data": "For a UCS:JS, the For Each statement is not defined in code but is a  property of the UCS . This allows CABINET VISION to process the conditions prior to executing the UCS:JS, if the condition is met the UCS:JS is primed and executed else execution is bypassed."
        },
        {
            "type": "link",
            "data": {
                "text": "property of the UCS",
                "uuid": "db3cc5fc-c4e0-45cd-bc5f-74f2e8778eaf",
                "description": "[Placeholder for AI-generated description]"
            }
        },
        {
            "type": "text",
            "data": "Objects"
        },
        {
            "type": "text",
            "data": "In a UCS:M, the macro is executed on the current CV object as defined in the for each statement. As CV is executing the UCS:M, it is able to relate the code directly to CV objects. There is therefore no requirement to identify an object in the UCS:M as it is implicitly implied. The UCS:M macros have a special Cab object to identify the current assembly."
        },
        {
            "type": "text",
            "data": ";UCS:M"
        },
        {
            "type": "text",
            "data": "DX = 5        ; Implicitly apply a value to the current object"
        },
        {
            "type": "text",
            "data": "If Cab.DX > 30 Then  ; Use of the assembly object"
        },
        {
            "type": "text",
            "data": "For a UCS:JS, a JavaScript runtime engine executes the script. The runtime engine has no direct knowledge of CV objects so in order for scripts to operate on CV objects, the runtime must be primed with a CV object. The runtime is primed with 2 CV objects, the current assembly (_cab) and current for each object (_this)."
        },
        {
            "type": "text",
            "data": "//UCS:JS"
        },
        {
            "type": "text",
            "data": "_this.DX = 5;    // Apply value to the current object"
        },
        {
            "type": "text",
            "data": "if (_cab.DX > 30)  // Use of the assembly object"
        },
        {
            "type": "text",
            "data": "Public Variables"
        },
        {
            "type": "text",
            "data": "In a UCS:M, public variables are defined in code. These are automatically extracted and displayed in the UCS Manager UI where the values may be edited."
        },
        {
            "type": "text",
            "data": ";UCS:M"
        },
        {
            "type": "text",
            "data": "Public PUB_VALUE=4 ;Public Value"
        },
        {
            "type": "text",
            "data": "DX = PUB_VALUE"
        },
        {
            "type": "text",
            "data": "For a UCS:JS, the public variables are defined in the UCS Manager UI and not in the JS code. For code execution they are defined as a JS var variable (see Variables below)."
        },
        {
            "type": "text",
            "data": "//UCS:JS"
        },
        {
            "type": "text",
            "data": "_this.DX = PUB_VALUE;"
        },
        {
            "type": "text",
            "data": "Variables"
        },
        {
            "type": "text",
            "data": "In a UCS:M, all variables are applied as parameters on the current object being processed. This means that they can be used in any equations that may be used to define values."
        },
        {
            "type": "text",
            "data": ";UCS:M"
        },
        {
            "type": "text",
            "data": "MY_VALUE = 5"
        },
        {
            "type": "text",
            "data": "DX = MY_VALUE * 2"
        },
        {
            "type": "text",
            "data": "For a UCS:JS, standard JS var values can be used during calculations, but it is important to note they are not parameters on the current object being processed."
        },
        {
            "type": "text",
            "data": "//UCS:JS"
        },
        {
            "type": "text",
            "data": "var MY_VALUE = 5;"
        },
        {
            "type": "text",
            "data": "_this.DX = MY_VALUE;     // Valid assignment"
        },
        {
            "type": "text",
            "data": "_this.DY = 'DX + MY_VALUE'; // Invalid use of var in an equation"
        },
        {
            "type": "text",
            "data": "Using a JS var can have a big performance advantage. For example, if the result of a parameter or equation evaluation is stored in a var, it only need be evaluated once instead of potentially multiple times."
        },
        {
            "type": "text",
            "data": "In the UCS:M below, a parameter evaluation occurs two times."
        },
        {
            "type": "text",
            "data": "if ( DY < 20 )     ; Evaluate parameter 1"
        },
        {
            "type": "text",
            "data": "ShowMessage(1);"
        },
        {
            "type": "text",
            "data": "else if ( DY > 50 )  ; Evaluate parameter 2"
        },
        {
            "type": "text",
            "data": "ShowMessage(3);"
        },
        {
            "type": "text",
            "data": "else"
        },
        {
            "type": "text",
            "data": "ShowMessage(2);"
        },
        {
            "type": "text",
            "data": "In a UCS:JS the code can be written so there is a single parameter evaluation."
        },
        {
            "type": "text",
            "data": "var length = _this.GetParameterValue('DY');   // Evaluate parameter 1"
        },
        {
            "type": "text",
            "data": "if ( length < 20 )"
        },
        {
            "type": "text",
            "data": "ShowMessage(1);"
        },
        {
            "type": "text",
            "data": "else if ( length > 50 )"
        },
        {
            "type": "text",
            "data": "ShowMessage(3);"
        },
        {
            "type": "text",
            "data": "else"
        },
        {
            "type": "text",
            "data": "ShowMessage(2);"
        },
        {
            "type": "text",
            "data": "Parameters"
        },
        {
            "type": "text",
            "data": "In a UCS:M, as all variables are applied as parameters, there is no difference between a system parameter such as DX and a user parameter such as MY_PARAM."
        },
        {
            "type": "text",
            "data": ";UCS:M"
        },
        {
            "type": "text",
            "data": "DX = 5"
        },
        {
            "type": "text",
            "data": "MY_PARAM = 5"
        },
        {
            "type": "text",
            "data": "For a UCS:JS, the JavaScript runtime has no concept of parameters so object methods must be used to set parameters explicitly. The most common parameters have been defined as object properties which are a shorthand method of setting the parameter value."
        },
        {
            "type": "text",
            "data": "//UCS:JS"
        },
        {
            "type": "text",
            "data": "_this.DX = 5;            // Property to set DX parameter"
        },
        {
            "type": "text",
            "data": "_this.SetParameter('DX', 5);     // Method to set DX parameter"
        },
        {
            "type": "text",
            "data": "_this.SetParameter('MY_PARAM', 5);  // Methods to set use parameter"
        },
        {
            "type": "text",
            "data": "The same applies to evaluating parameters in a UCS:JS."
        },
        {
            "type": "text",
            "data": "//UCS:JS"
        },
        {
            "type": "text",
            "data": "var dx1 = _this.DX;"
        },
        {
            "type": "text",
            "data": "var dx2 = _this.GetParameterValue('DX');"
        },
        {
            "type": "text",
            "data": "var my_param = _this.GetParameterValue('MY_PARAM');"
        },
        {
            "type": "text",
            "data": "Case sensitivity"
        },
        {
            "type": "text",
            "data": "In a USC:M, all parameters and objects are case insensitive, in other words upper-case and lower-case characters can be used interchangeably."
        },
        {
            "type": "text",
            "data": ";UCS:M"
        },
        {
            "type": "text",
            "data": "DX = 5           ; All upper case OK"
        },
        {
            "type": "text",
            "data": "Dx = 5           ; Mixed case OK"
        },
        {
            "type": "text",
            "data": "dx = 5           ; All lower case OK"
        },
        {
            "type": "text",
            "data": "If Cab.DX > cab.DY THEN   ; Mixed case OK"
        },
        {
            "type": "text",
            "data": "JavaScript however is a case sensitive language so syntax and objects must use the correct case."
        },
        {
            "type": "text",
            "data": "//UCS:JS"
        },
        {
            "type": "text",
            "data": "_this.DX = 5;        // All upper case property OK"
        },
        {
            "type": "text",
            "data": "_this.Dx = 5;        // Mixed case invalid"
        },
        {
            "type": "text",
            "data": "_this.dx = 5;        // Lower case invalid"
        },
        {
            "type": "text",
            "data": "If (_Cab.DX > _cab.DY)   // Mixed case invalid"
        },
        {
            "type": "text",
            "data": "if (_cab.DX > _cab.DY)   // Correct case"
        },
        {
            "type": "text",
            "data": "Even in UCS:JS, using an object Evaluation method to evaluate a formula, mixed case is permissible as the evaluation of expressions is relegated to CV which is case insensitive."
        },
        {
            "type": "text",
            "data": "//UCS:JS"
        },
        {
            "type": "text",
            "data": "_this.DX = 'dy / 2';       // Assigns an equation to DX so mixed case OK"
        },
        {
            "type": "text",
            "data": "_this.Evaluate('(DX+dy)/2');   // Using CV expresion evaluation so mixed case OK"
        },
        {
            "type": "text",
            "data": "Functions"
        },
        {
            "type": "text",
            "data": "UCS:M do not have the concept of user defined functions. In UCS:JS standard JS function can be used to isolate logic into neat components."
        },
        {
            "type": "text",
            "data": "function CalculatePrice(length)"
        },
        {
            "type": "text",
            "data": "{"
        },
        {
            "type": "text",
            "data": "if ( length < 20 )"
        },
        {
            "type": "text",
            "data": "return length * 1.5;"
        },
        {
            "type": "text",
            "data": "else if ( length < 30 )"
        },
        {
            "type": "text",
            "data": "return length * 1.85;"
        },
        {
            "type": "text",
            "data": "return length * 2.25;"
        },
        {
            "type": "text",
            "data": "}"
        },
        {
            "type": "text",
            "data": "var price = CalculatePrice(_this.GetParameterValue('DY'));"
        },
        {
            "type": "text",
            "data": "_this.SetParameter('PRICE', price, VAL_CURRENCY);"
        },
        {
            "type": "text",
            "data": "Data Structure"
        },
        {
            "type": "text",
            "data": "As mentioned previously UCS:M do not have the concept of variables and data structures as all data is considered an object parameter. In UCS:JS, all the standard JS data and data collections are available."
        },
        {
            "type": "text",
            "data": "const size = new Map(["
        },
        {
            "type": "text",
            "data": "[1, 'short'],"
        },
        {
            "type": "text",
            "data": "[2, 'medium'],"
        },
        {
            "type": "text",
            "data": "[3, 'long']"
        },
        {
            "type": "text",
            "data": "]);"
        },
        {
            "type": "text",
            "data": "function ShowMessage(key)"
        },
        {
            "type": "text",
            "data": "{"
        },
        {
            "type": "text",
            "data": "alert('A ' + size.get(key) + ' part in ' + _cab.NAME);"
        },
        {
            "type": "text",
            "data": "}"
        },
        {
            "type": "text",
            "data": "var length = _this.GetParameterValue('DY');"
        },
        {
            "type": "text",
            "data": "if ( length < 20 )"
        },
        {
            "type": "text",
            "data": "ShowMessage(1);"
        },
        {
            "type": "text",
            "data": "else if ( length > 50 )"
        },
        {
            "type": "text",
            "data": "ShowMessage(3);"
        },
        {
            "type": "text",
            "data": "else"
        },
        {
            "type": "text",
            "data": "ShowMessage(2);"
        },
        {
            "type": "text",
            "data": "Example"
        },
        {
            "type": "text",
            "data": "UCS:M to adjust an adjustable shelf part width under a number of conditions."
        },
        {
            "type": "text",
            "data": ";UCS:M"
        },
        {
            "type": "text",
            "data": ";Adjust Adjustable/Fixed Shelf"
        },
        {
            "type": "text",
            "data": "For Each AS|FS Part"
        },
        {
            "type": "text",
            "data": "If Cab.ConstID = AsmConstID('Frameless') Then"
        },
        {
            "type": "text",
            "data": "If Cab.DX >= 25 Then"
        },
        {
            "type": "text",
            "data": "If Cab.Type = ASM_TYPE_STANDARD Then"
        },
        {
            "type": "text",
            "data": "DY += 10;"
        },
        {
            "type": "text",
            "data": "End If"
        },
        {
            "type": "text",
            "data": "End If"
        },
        {
            "type": "text",
            "data": "End If"
        },
        {
            "type": "text",
            "data": "Equivalent UCS:JS."
        },
        {
            "type": "text",
            "data": "//Adjust Adjustable/Fixed Shelf"
        },
        {
            "type": "text",
            "data": "if (_cab.GetParameterValue('CONSTID') == _this.QueryID(ID_ASSEMBLYCONSTRUCTION, 'Frameless')) {"
        },
        {
            "type": "text",
            "data": "if (_cab.DX >= 25 ) {"
        },
        {
            "type": "text",
            "data": "if (_cab.TYPE == ASM_TYPE_STANDARD) {"
        },
        {
            "type": "text",
            "data": "_this.DY += 10;"
        },
        {
            "type": "text",
            "data": "}"
        },
        {
            "type": "text",
            "data": "}"
        },
        {
            "type": "text",
            "data": "}"
        },
        {
            "type": "text",
            "data": "See the  JavaScript Object Model  topic for more information."
        },
        {
            "type": "link",
            "data": {
                "text": "JavaScript Object Model",
                "uuid": "73fe6410-b796-435a-ae71-5dcfbc855c76",
                "description": "[Placeholder for AI-generated description]"
            }
        }
    ],
    "source_file": "CVEnglish\\Tips_Tricks_FAQs\\UCS\\JavaScript_User_Created_Standards\\JavaScript_UCS.htm",
    "version": "2024",
    "source_type": "help_file"
}